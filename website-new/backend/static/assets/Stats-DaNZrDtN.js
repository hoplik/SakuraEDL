import{a as B}from"./index-DaRRqj3k.js";import{_ as U,o as H,a as K,b as c,c as r,d as t,t as o,f as y,F as w,r as T,i as O,h as _,n as x,x as Q}from"./index-vrOceqiF.js";const Y={class:"stats-page container"},G={class:"stats-header"},J={class:"header-right"},R={class:"live-clock"},W={class:"clock-time"},X={class:"refresh-info"},Z=["disabled"],tt={key:0,class:"total-stats"},st={class:"total-card"},et={class:"total-info"},at={class:"total-value"},ot={class:"total-card"},lt={class:"total-info"},nt={class:"total-value"},ct={class:"total-card highlight"},rt={class:"total-info"},it={class:"total-value"},dt={class:"platform-tabs"},ut=["onClick"],_t={class:"tab-icon"},vt={class:"tab-name"},mt={key:0,class:"tab-badge"},yt={key:1,class:"platform-stats"},gt={class:"stats-grid"},pt={class:"stat-info"},ht={class:"stat-value"},ft={class:"stat-label"},kt={key:0,class:"recent-section"},bt={class:"section-icon"},St={class:"device-table"},Ct={key:1,class:"empty-devices"},Dt={key:2,class:"loading"},wt={key:3,class:"error-msg"},Tt={__name:"Stats",setup(xt){const g=_(null),p=_(!0),h=_(""),I=_(""),v=_({}),i=_("qualcomm");let f=null,k=null;const b=[{key:"qualcomm",name:"Qualcomm é«˜é€š",icon:"ðŸ“±"},{key:"mtk",name:"MTK è”å‘ç§‘",icon:"âš¡"},{key:"spd",name:"SPD å±•é”",icon:"ðŸ”§"}],N=[{key:"resources",label:"äº‘ç«¯èµ„æº",emoji:"ðŸ“¦",icon:"resources"},{key:"logs",label:"è®¾å¤‡æ—¥å¿—",emoji:"ðŸ“Š",icon:"logs"},{key:"today_logs",label:"ä»Šæ—¥æ´»è·ƒ",emoji:"ðŸ”¥",icon:"today"}],u=e=>{var s;return(s=g.value)==null?void 0:s[e]},M=e=>{var s;return((s=b.find(n=>n.key===e))==null?void 0:s.name)||e},P=e=>{var s;return((s=b.find(n=>n.key===e))==null?void 0:s.icon)||"ðŸ“±"},$=e=>({qualcomm:{label:"å­˜å‚¨ç±»åž‹",key:"storage_type"},mtk:{label:"DA æ¨¡å¼",key:"da_mode"},spd:{label:"å®‰å…¨å¯åŠ¨",key:"secure_boot"}})[e]||{label:"-",key:""},F=(e,s)=>{const n=$(e).key;if(!n)return"-";const l=s[n];return e==="qualcomm"?l==null?void 0:l.toUpperCase():e==="spd"?l==="true"||l==="1"?"å¼€å¯":"å…³é—­":l},q=()=>{const e=new Date,s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),d=String(e.getMinutes()).padStart(2,"0"),m=String(e.getSeconds()).padStart(2,"0");I.value=`${s}-${n}-${l} ${a}:${d}:${m}`},S=(e,s,n=1e3)=>{const l=v.value[s]||0,a=e;if(l===a)return;const d=performance.now(),m=V=>{const z=V-d,D=Math.min(z/n,1),A=D===1?1:1-Math.pow(2,-10*D);v.value[s]=Math.floor(l+(a-l)*A),D<1&&requestAnimationFrame(m)};requestAnimationFrame(m)},j=e=>({success:"success",matched:"success",failed:"danger",info_collected:"info",not_found:"warning"})[e]||"info",E=e=>({success:"æˆåŠŸ",matched:"åŒ¹é…",failed:"å¤±è´¥",info_collected:"æ”¶é›†",not_found:"æœªåŒ¹é…"})[e]||e||"-",L=e=>{if(!e)return"-";try{return new Date(e).toLocaleString("zh-CN")}catch{return e}},C=async()=>{p.value=!0;try{const e=await B.getStatsOverview();e.code===0?(g.value=e.data,S(e.data.total_resources||0,"total_resources",800),S(e.data.total_logs||0,"total_logs",800),S(e.data.today_logs||0,"today_logs",800)):h.value=e.message||"èŽ·å–ç»Ÿè®¡å¤±è´¥"}catch{h.value="ç½‘ç»œè¯·æ±‚å¤±è´¥"}finally{p.value=!1}};return H(()=>{q(),f=setInterval(q,1e3),C(),k=setInterval(C,3e4)}),K(()=>{f&&clearInterval(f),k&&clearInterval(k)}),(e,s)=>{var n,l;return c(),r("div",Y,[t("div",G,[s[2]||(s[2]=t("div",{class:"header-left"},[t("h1",null,"å®žæ—¶ç»Ÿè®¡"),t("p",{class:"page-desc"},"SakuraEDL äº‘ç«¯æœåŠ¡ - å¤šå¹³å°å®žæ—¶æ•°æ®ç»Ÿè®¡")],-1)),t("div",J,[t("div",R,[s[0]||(s[0]=t("span",{class:"live-dot"},null,-1)),t("span",W,o(I.value),1)]),t("div",X,[s[1]||(s[1]=t("span",null,"æ•°æ®æ¯ 30 ç§’è‡ªåŠ¨åˆ·æ–°",-1)),t("button",{class:"refresh-btn",onClick:C,disabled:p.value}," ðŸ”„ åˆ·æ–° ",8,Z)])])]),g.value?(c(),r("div",tt,[t("div",st,[s[4]||(s[4]=t("div",{class:"total-icon"},"ðŸ“Š",-1)),t("div",et,[t("span",at,o(v.value.total_resources||0),1),s[3]||(s[3]=t("span",{class:"total-label"},"äº‘ç«¯èµ„æºæ€»æ•°",-1))])]),t("div",ot,[s[6]||(s[6]=t("div",{class:"total-icon"},"ðŸ“±",-1)),t("div",lt,[t("span",nt,o(v.value.total_logs||0),1),s[5]||(s[5]=t("span",{class:"total-label"},"è®¾å¤‡è¿žæŽ¥æ€»æ•°",-1))])]),t("div",ct,[s[8]||(s[8]=t("div",{class:"total-icon"},"ðŸ”¥",-1)),t("div",rt,[t("span",it,o(v.value.today_logs||0),1),s[7]||(s[7]=t("span",{class:"total-label"},"ä»Šæ—¥æ´»è·ƒ",-1))])])])):y("",!0),t("div",dt,[(c(),r(w,null,T(b,a=>{var d;return t("button",{key:a.key,class:x(["platform-tab",{active:i.value===a.key}]),onClick:m=>i.value=a.key},[t("span",_t,o(a.icon),1),t("span",vt,o(a.name),1),(d=u(a.key))!=null&&d.today_logs?(c(),r("span",mt,o(u(a.key).today_logs),1)):y("",!0)],10,ut)}),64))]),g.value&&u(i.value)?(c(),r("div",yt,[t("div",gt,[(c(),r(w,null,T(N,(a,d)=>t("div",{class:"stat-card",key:a.key,style:Q({animationDelay:d*.1+"s"})},[t("div",{class:x(["stat-icon",a.icon])},o(a.emoji),3),t("div",pt,[t("span",ht,o(u(i.value)[a.key]||0),1),t("span",ft,o(a.label),1)])],4)),64))]),(l=(n=u(i.value))==null?void 0:n.recent_devices)!=null&&l.length?(c(),r("section",kt,[t("h2",null,[t("span",bt,o(P(i.value)),1),O(" æœ€è¿‘ "+o(M(i.value))+" è®¾å¤‡ ",1)]),t("div",St,[t("table",null,[t("thead",null,[t("tr",null,[s[9]||(s[9]=t("th",null,"èŠ¯ç‰‡ ID",-1)),s[10]||(s[10]=t("th",null,"èŠ¯ç‰‡åç§°",-1)),t("th",null,o($(i.value).label),1),s[11]||(s[11]=t("th",null,"ç»“æžœ",-1)),s[12]||(s[12]=t("th",null,"æ—¶é—´",-1))])]),t("tbody",null,[(c(!0),r(w,null,T(u(i.value).recent_devices,(a,d)=>(c(),r("tr",{key:d},[t("td",null,[t("code",null,o(a.chip_id||"-"),1)]),t("td",null,o(a.chip_name||"-"),1),t("td",null,o(F(i.value,a)||"-"),1),t("td",null,[t("span",{class:x(["tag",j(a.match_result)])},o(E(a.match_result)),3)]),t("td",null,o(L(a.created_at)),1)]))),128))])])])])):(c(),r("div",Ct,[t("p",null,"æš‚æ—  "+o(M(i.value))+" è®¾å¤‡è¿žæŽ¥è®°å½•",1)]))])):y("",!0),p.value?(c(),r("div",Dt)):y("",!0),h.value?(c(),r("div",wt,o(h.value),1)):y("",!0)])}}},$t=U(Tt,[["__scopeId","data-v-4cf519d1"]]);export{$t as default};
