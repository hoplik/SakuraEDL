import{H as V,o as c,c as _,a as t,d as e,w as l,t as n,b as p,F as w,k as C,I as b,J as q,j as L,r as v,G as B,f as u,K as F,y as j,L as D,M as I,N as K,x as O,C as P,B as H,O as R,p as z,P as T,Q as A,R as E}from"./index-CR8vSeWZ.js";const G={class:"page-header"},J={class:"stats-grid"},Q={class:"stat-card primary"},U={class:"stat-icon"},W={class:"value"},X={class:"stat-card success"},Y={class:"stat-icon"},Z={class:"value"},tt={class:"trend up"},st={class:"stat-card warning"},et={class:"stat-icon"},lt={class:"value"},at={class:"stat-card danger"},ot={class:"stat-icon"},dt={class:"value"},nt={class:"quick-actions"},it={class:"icon",style:{background:"rgba(102,126,234,0.1)",color:"#667eea"}},rt={class:"icon",style:{background:"rgba(16,185,129,0.1)",color:"#10b981"}},ut={class:"icon",style:{background:"rgba(245,158,11,0.1)",color:"#f59e0b"}},ct={style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"24px"}},_t={class:"card"},pt={class:"card-header"},vt={class:"card-title"},ft={class:"card-body"},ht={style:{display:"flex",gap:"24px","flex-wrap":"wrap"}},bt={style:{"font-size":"28px","font-weight":"700","margin-top":"12px",color:"#1e293b"}},gt={key:0,style:{color:"#64748b"}},mt={class:"card"},yt={class:"card-header"},xt={class:"card-title"},kt={class:"card-body"},wt={style:{display:"flex",gap:"12px","flex-wrap":"wrap"}},Ct={key:0,style:{color:"#64748b","font-size":"13px"}},Lt={class:"card",style:{"margin-top":"24px"}},zt={class:"card-header"},$t={class:"card-title"},Mt={class:"card-body",style:{padding:"0"}},Nt={style:{"font-family":"monospace","font-size":"13px",color:"#667eea"}},St={style:{"font-family":"monospace","font-size":"11px",color:"#64748b"}},Vt={style:{color:"#64748b","font-size":"12px"}},qt={key:0,style:{"text-align":"center",padding:"40px",color:"#64748b"}},jt={__name:"Dashboard",setup(Bt){const h=L(!1),d=L({}),$=B(()=>{const a=d.value.total_loaders||1,s=d.value.enabled_loaders||0;return Math.round(s/a*100)}),g=async()=>{h.value=!0;try{const a=await q.getStats();a.code===0&&(d.value=a.data)}catch(a){console.error("加载统计失败",a)}h.value=!1},m=a=>a>=1e6?(a/1e6).toFixed(1)+"M":a>=1e3?(a/1e3).toFixed(1)+"K":a.toString(),M=a=>({none:"无验证",miauth:"小米",demacia:"一加",vip:"VIP"})[a]||a;return V(()=>{g()}),(a,s)=>{var k;const r=v("el-icon"),y=v("el-button"),f=v("el-table-column"),N=v("el-tooltip"),x=v("el-tag"),S=v("el-table");return c(),_("div",null,[t("div",G,[s[5]||(s[5]=t("div",null,[t("h1",{class:"page-title"},"仪表盘"),t("p",{class:"page-subtitle"},"Loader 云端管理系统概览")],-1)),e(y,{onClick:g,loading:h.value,round:""},{default:l(()=>[e(r,null,{default:l(()=>[e(u(F))]),_:1}),s[4]||(s[4]=p(" 刷新数据 ",-1))]),_:1},8,["loading"])]),t("div",J,[t("div",Q,[t("div",U,[e(r,null,{default:l(()=>[e(u(j))]),_:1})]),s[6]||(s[6]=t("h3",null,"Loader 总数",-1)),t("div",W,n(d.value.total_loaders||0),1)]),t("div",X,[t("div",Y,[e(r,null,{default:l(()=>[e(u(D))]),_:1})]),s[7]||(s[7]=t("h3",null,"已启用",-1)),t("div",Z,n(d.value.enabled_loaders||0),1),t("div",tt,n($.value)+"% 启用率 ",1)]),t("div",st,[t("div",et,[e(r,null,{default:l(()=>[e(u(I))]),_:1})]),s[8]||(s[8]=t("h3",null,"总下载次数",-1)),t("div",lt,n(m(d.value.total_downloads||0)),1)]),t("div",at,[t("div",ot,[e(r,null,{default:l(()=>[e(u(K))]),_:1})]),s[9]||(s[9]=t("h3",null,"总匹配次数",-1)),t("div",dt,n(m(d.value.total_matches||0)),1)])]),t("div",nt,[t("div",{class:"quick-action-btn",onClick:s[0]||(s[0]=o=>a.$router.push("/upload"))},[t("div",it,[e(r,null,{default:l(()=>[e(u(O))]),_:1})]),s[10]||(s[10]=t("div",{class:"text"},[t("h4",null,"上传 Loader"),t("p",null,"添加新的 Loader 文件")],-1))]),t("div",{class:"quick-action-btn",onClick:s[1]||(s[1]=o=>a.$router.push("/loaders"))},[t("div",rt,[e(r,null,{default:l(()=>[e(u(P))]),_:1})]),s[11]||(s[11]=t("div",{class:"text"},[t("h4",null,"管理 Loader"),t("p",null,"编辑或删除现有 Loader")],-1))]),t("div",{class:"quick-action-btn",onClick:s[2]||(s[2]=o=>a.$router.push("/logs"))},[t("div",ut,[e(r,null,{default:l(()=>[e(u(H))]),_:1})]),s[12]||(s[12]=t("div",{class:"text"},[t("h4",null,"查看日志"),t("p",null,"设备匹配记录")],-1))])]),t("div",ct,[t("div",_t,[t("div",pt,[t("span",vt,[e(r,null,{default:l(()=>[e(u(R))]),_:1}),s[13]||(s[13]=p(" 验证类型分布",-1))])]),t("div",ft,[t("div",ht,[(c(!0),_(w,null,C(d.value.auth_type_stats,(o,i)=>(c(),_("div",{key:i,style:{"text-align":"center",flex:"1","min-width":"80px"}},[t("span",{class:z(["auth-tag",i])},n(M(i)),3),t("div",bt,n(o),1),s[14]||(s[14]=t("div",{style:{"font-size":"12px",color:"#64748b"}},"个 Loader",-1))]))),128)),!d.value.auth_type_stats||Object.keys(d.value.auth_type_stats).length===0?(c(),_("div",gt," 暂无数据 ")):b("",!0)])])]),t("div",mt,[t("div",yt,[t("span",xt,[e(r,null,{default:l(()=>[e(u(T))]),_:1}),s[15]||(s[15]=p(" 厂商分布",-1))])]),t("div",kt,[t("div",wt,[(c(!0),_(w,null,C(d.value.vendor_stats,(o,i)=>(c(),_("div",{key:i,class:z(["vendor-badge",i.toLowerCase()])},n(i)+": "+n(o),3))),128)),!d.value.vendor_stats||Object.keys(d.value.vendor_stats).length===0?(c(),_("div",Ct," 暂无数据 ")):b("",!0)])])])]),t("div",Lt,[t("div",zt,[t("span",$t,[e(r,null,{default:l(()=>[e(u(A))]),_:1}),s[16]||(s[16]=p(" 最近匹配的设备",-1))]),e(y,{text:"",onClick:s[3]||(s[3]=o=>a.$router.push("/logs"))},{default:l(()=>[...s[17]||(s[17]=[p("查看全部",-1)])]),_:1})]),t("div",Mt,[e(S,{data:d.value.recent_devices||[],stripe:""},{default:l(()=>[e(f,{prop:"msm_id",label:"MSM ID",width:"120"},{default:l(({row:o})=>[t("span",Nt,n(o.msm_id),1)]),_:1}),e(f,{prop:"pk_hash",label:"PK Hash"},{default:l(({row:o})=>[e(N,{content:o.pk_hash,placement:"top"},{default:l(()=>{var i;return[t("span",St,n((i=o.pk_hash)==null?void 0:i.substring(0,40))+"... ",1)]}),_:2},1032,["content"])]),_:1}),e(f,{prop:"storage_type",label:"存储",width:"80"},{default:l(({row:o})=>[e(x,{size:"small",type:"info"},{default:l(()=>{var i;return[p(n((i=o.storage_type)==null?void 0:i.toUpperCase()),1)]}),_:2},1024)]),_:1}),e(f,{prop:"match_result",label:"结果",width:"100"},{default:l(({row:o})=>[e(x,{type:o.match_result==="matched"?"success":"danger",size:"small",effect:"dark"},{default:l(()=>[p(n(o.match_result==="matched"?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"created_at",label:"时间",width:"180"},{default:l(({row:o})=>[t("span",Vt,n(o.created_at),1)]),_:1})]),_:1},8,["data"]),(k=d.value.recent_devices)!=null&&k.length?b("",!0):(c(),_("div",qt,[e(r,{style:{"font-size":"48px","margin-bottom":"12px"}},{default:l(()=>[e(u(E))]),_:1}),s[18]||(s[18]=t("p",null,"暂无匹配记录",-1))]))])])])}}};export{jt as default};
