// ============================================================================
// SakuraEDL - Exploit Interface | 漏洞利用接口
// ============================================================================
// [ZH] 漏洞利用接口 - 定义漏洞利用的抽象接口
// [EN] Exploit Interface - Define abstract interface for exploits
// [JA] エクスプロイトインターフェース - エクスプロイトの抽象インターフェース
// [KO] 익스플로잇 인터페이스 - 익스플로잇 추상 인터페이스 정의
// [RU] Интерфейс эксплойтов - Абстрактный интерфейс для эксплойтов
// [ES] Interfaz de exploit - Definir interfaz abstracta para exploits
// ============================================================================
// Copyright (c) 2025-2026 SakuraEDL | MIT License
// ============================================================================

using System.IO.Ports;
using System.Threading;
using System.Threading.Tasks;

namespace SakuraEDL.Qualcomm.Exploit
{
    /// <summary>
    /// 漏洞利用接口
    /// </summary>
    public interface IExploit
    {
        /// <summary>
        /// 漏洞名称
        /// </summary>
        string Name { get; }

        /// <summary>
        /// 支持的芯片列表
        /// </summary>
        string[] SupportedChips { get; }

        /// <summary>
        /// 检查设备是否可被利用
        /// </summary>
        Task<bool> CanExploitAsync(SerialPort port, PblDeviceInfo deviceInfo, CancellationToken ct);

        /// <summary>
        /// 执行漏洞利用
        /// </summary>
        Task<ExploitResult> ExecuteAsync(SerialPort port, PblDeviceInfo deviceInfo, CancellationToken ct);
    }
}
