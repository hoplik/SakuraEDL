// ============================================================================
// LoveAlways - 漏洞利用接口
// ============================================================================

using System.IO.Ports;
using System.Threading;
using System.Threading.Tasks;

namespace LoveAlways.Qualcomm.Exploit
{
    /// <summary>
    /// 漏洞利用接口
    /// </summary>
    public interface IExploit
    {
        /// <summary>
        /// 漏洞名称
        /// </summary>
        string Name { get; }

        /// <summary>
        /// 支持的芯片列表
        /// </summary>
        string[] SupportedChips { get; }

        /// <summary>
        /// 检查设备是否可被利用
        /// </summary>
        Task<bool> CanExploitAsync(SerialPort port, PblDeviceInfo deviceInfo, CancellationToken ct);

        /// <summary>
        /// 执行漏洞利用
        /// </summary>
        Task<ExploitResult> ExecuteAsync(SerialPort port, PblDeviceInfo deviceInfo, CancellationToken ct);
    }
}
